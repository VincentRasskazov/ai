<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VincentAI | Command Node</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;500;700&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --bg-dark: #030712;
            --panel-bg: #111827;
            --accent: #6366f1; /* Indigo */
            --accent-glow: rgba(99, 102, 241, 0.15);
            --text-main: #f3f4f6;
            --text-dim: #9ca3af;
        }

        body {
            background-color: var(--bg-dark);
            color: var(--text-main);
            font-family: 'Space Grotesk', sans-serif;
            height: 100vh;
            overflow: hidden;
        }

        /* Glassmorphism & Borders */
        .glass-panel {
            background: rgba(17, 24, 39, 0.7);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.08);
        }

        .glow-border {
            box-shadow: 0 0 20px var(--accent-glow);
            border: 1px solid rgba(99, 102, 241, 0.3);
        }

        /* Chat Bubbles */
        .bubble-user {
            background: linear-gradient(135deg, #4f46e5, #4338ca);
            border-radius: 1.5rem 1.5rem 0 1.5rem;
            box-shadow: 0 4px 15px rgba(79, 70, 229, 0.3);
        }

        .bubble-ai {
            background: #1f2937;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 1.5rem 1.5rem 1.5rem 0;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.95rem;
            line-height: 1.6;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #374151; border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background: #4b5563; }

        /* Animations */
        @keyframes fadeUp {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .msg-enter { animation: fadeUp 0.3s ease-out forwards; }
    </style>
</head>
<body class="flex flex-col md:flex-row h-screen p-2 md:p-4 gap-4 bg-[url('https://assets.codepen.io/13471/sparkles.gif')] bg-repeat bg-[length:500px]">

    <aside class="w-full md:w-80 flex flex-col gap-4 glass-panel rounded-2xl p-6 shadow-2xl z-10">
        <div class="flex items-center gap-3 pb-6 border-b border-white/10">
            <div class="w-10 h-10 rounded-xl bg-indigo-600 flex items-center justify-center shadow-[0_0_15px_rgba(79,70,229,0.5)]">
                <i class="fa-solid fa-cube text-white text-lg"></i>
            </div>
            <div>
                <h1 class="font-bold text-2xl tracking-tight">VincentAI</h1>
                <p class="text-[10px] text-indigo-400 font-mono tracking-widest uppercase">Neural Interface v2.0</p>
            </div>
        </div>

        <div class="space-y-4 overflow-y-auto flex-1 pr-2">
            <div class="text-xs font-bold text-slate-500 uppercase tracking-wider mb-2">Active Neural Core</div>
            
            <div class="relative">
                <select id="model-select" class="w-full bg-slate-800/50 text-sm border border-slate-700 text-slate-200 rounded-xl p-3 appearance-none focus:outline-none focus:border-indigo-500 transition-all cursor-pointer hover:bg-slate-800">
                    </select>
                <div class="absolute right-3 top-3.5 text-slate-400 pointer-events-none">
                    <i class="fa-solid fa-chevron-down text-xs"></i>
                </div>
            </div>

            <div class="p-4 rounded-xl bg-slate-800/30 border border-slate-700/50 mt-4">
                <div class="flex items-center gap-2 mb-2">
                    <div class="w-2 h-2 rounded-full bg-emerald-500 shadow-[0_0_8px_#10b981]"></div>
                    <span class="text-xs font-mono text-emerald-400">SYSTEM ONLINE</span>
                </div>
                <div class="text-[10px] text-slate-500 font-mono leading-relaxed">
                    Routing traffic via secure API wrappers.<br>
                    Latency: <span class="text-slate-300">~120ms</span><br>
                    Encryption: <span class="text-slate-300">TLS 1.3</span>
                </div>
            </div>
        </div>

        <div class="mt-auto pt-4 border-t border-white/5 text-[10px] text-slate-600 text-center">
            Based on FreeDeepAI Protocol
        </div>
    </aside>

    <main class="flex-1 flex flex-col glass-panel rounded-2xl relative overflow-hidden shadow-2xl z-0">
        
        <div id="chat-box" class="flex-1 overflow-y-auto p-6 space-y-6 scroll-smooth">
            <div class="flex gap-4 max-w-3xl">
                <div class="w-8 h-8 rounded-full bg-indigo-500/10 border border-indigo-500/20 flex items-center justify-center flex-shrink-0">
                    <i class="fa-solid fa-robot text-indigo-400 text-xs"></i>
                </div>
                <div class="bubble-ai p-4">
                    <p>VincentAI initialized. Connected to DeepAI nodes.</p>
                    <p class="mt-2 text-xs text-slate-500">Selected Model: <span id="current-model-display" class="text-indigo-400">DeepSeek V3.2</span></p>
                </div>
            </div>
        </div>

        <div class="p-4 bg-slate-900/50 border-t border-white/5 backdrop-blur-md">
            <form id="chat-form" class="max-w-4xl mx-auto relative flex items-center gap-3">
                <div class="relative flex-1">
                    <input type="text" id="user-input" 
                        class="w-full bg-slate-800/50 border border-slate-700 text-slate-100 rounded-xl py-4 pl-5 pr-12 focus:outline-none focus:border-indigo-500 focus:bg-slate-800 transition-all placeholder-slate-500 shadow-inner"
                        placeholder="Enter command or query..." autocomplete="off">
                    <div class="absolute right-4 top-4 text-slate-500">
                        <i class="fa-solid fa-terminal text-sm"></i>
                    </div>
                </div>
                <button type="submit" id="send-btn" class="p-4 rounded-xl bg-indigo-600 hover:bg-indigo-500 text-white transition-all shadow-[0_0_15px_rgba(79,70,229,0.4)] active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed">
                    <i class="fa-solid fa-paper-plane"></i>
                </button>
            </form>
        </div>
    </main>

    <script>
        // --- CONFIGURATION FROM FREEDEEPAI.PY ---
        const CONFIG = {
            url: "https://api.deepai.org/hacking_is_a_serious_crime",
            models: [
                "DeepSeek V3.2",
                "Llama 3.3 70B Instruct",
                "Qwen3 30B",
                "GPT-4o mini",
                "Gemma 3 12B",
                "Gemma2 9B",
                "GPT-4.1 Nano"
            ],
            // Headers extracted from the python script
            headers: {
                "api-key": "tryit-48957598737-7bf6498cad4adf00c76eb3dfa97dc26d",
                "User-Agent": "python-deepai-client/1.0",
                "hacker_is_stinky": "very_stinky" 
                // Note: 'Origin' and 'Referer' are usually blocked by browsers in fetch()
            }
        };

        const chatBox = document.getElementById('chat-box');
        const chatForm = document.getElementById('chat-form');
        const userInput = document.getElementById('user-input');
        const sendBtn = document.getElementById('send-btn');
        const modelSelect = document.getElementById('model-select');
        const currentModelDisplay = document.getElementById('current-model-display');

        // Initialize Models
        function init() {
            CONFIG.models.forEach((model, index) => {
                const opt = document.createElement('option');
                opt.value = model;
                opt.textContent = `${index + 1}. ${model}`;
                modelSelect.appendChild(opt);
            });
            
            modelSelect.addEventListener('change', () => {
                currentModelDisplay.textContent = modelSelect.value;
            });
        }

        // UI: Append Message
        function appendMessage(role, text, isError = false) {
            const div = document.createElement('div');
            div.className = "flex gap-4 max-w-3xl msg-enter " + (role === 'user' ? "ml-auto flex-row-reverse" : "");
            
            const iconUser = `<div class="w-8 h-8 rounded-full bg-slate-700 flex items-center justify-center flex-shrink-0 shadow-lg"><i class="fa-solid fa-user text-slate-300 text-xs"></i></div>`;
            const iconAi = `<div class="w-8 h-8 rounded-full bg-indigo-500/10 border border-indigo-500/20 flex items-center justify-center flex-shrink-0"><i class="fa-solid fa-robot text-indigo-400 text-xs"></i></div>`;

            const bubbleClass = role === 'user' ? 'bubble-user text-white' : 'bubble-ai text-slate-200';
            const errorStyle = isError ? 'border border-red-500/50 bg-red-900/20 text-red-200' : '';

            div.innerHTML = `
                ${role === 'user' ? iconUser : iconAi}
                <div class="${bubbleClass} p-4 max-w-[85%] ${errorStyle}">
                    <p class="whitespace-pre-wrap">${text}</p>
                </div>
            `;
            
            chatBox.appendChild(div);
            chatBox.scrollTop = chatBox.scrollHeight;
            return div;
        }

        // LOGIC: Send to DeepAI
        async function sendMessage(message, model) {
            const formData = new FormData();
            formData.append('chat_style', 'chat');
            formData.append('chatHistory', JSON.stringify([{ role: "user", content: message }]));
            formData.append('model', model);
            formData.append('enabled_tools', JSON.stringify(["image_generator", "image_editor"]));
            
            // Note: The Python script adds 'hacker_is_stinky' to body implicitly or header. 
            // In fetch, we add to FormData if the API expects it there, or headers if strict.
            // The script puts it in the payload dictionary, so we append it here.
            formData.append('hacker_is_stinky', 'very_stinky');

            try {
                const response = await fetch(CONFIG.url, {
                    method: 'POST',
                    headers: CONFIG.headers,
                    body: formData
                });

                if (!response.ok) {
                    throw new Error(`Server responded with ${response.status}`);
                }

                const result = await response.text();
                return result.trim();

            } catch (error) {
                console.error(error);
                throw error;
            }
        }

        // Handler
        chatForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            const text = userInput.value.trim();
            if (!text) return;

            // UI Updates
            userInput.value = '';
            userInput.disabled = true;
            sendBtn.disabled = true;
            appendMessage('user', text);

            // Typing Indicator
            const loadingDiv = document.createElement('div');
            loadingDiv.className = "flex gap-4 max-w-3xl msg-enter";
            loadingDiv.innerHTML = `
                <div class="w-8 h-8 rounded-full bg-indigo-500/10 border border-indigo-500/20 flex items-center justify-center flex-shrink-0"><i class="fa-solid fa-robot text-indigo-400 text-xs"></i></div>
                <div class="bubble-ai p-4 flex gap-2 items-center">
                    <span class="w-2 h-2 bg-indigo-400 rounded-full animate-bounce"></span>
                    <span class="w-2 h-2 bg-indigo-400 rounded-full animate-bounce delay-75"></span>
                    <span class="w-2 h-2 bg-indigo-400 rounded-full animate-bounce delay-150"></span>
                </div>
            `;
            chatBox.appendChild(loadingDiv);

            try {
                const model = modelSelect.value;
                const response = await sendMessage(text, model);
                loadingDiv.remove();
                appendMessage('ai', response);
            } catch (err) {
                loadingDiv.remove();
                let msg = "Connection Error.";
                if (err.message.includes("Failed to fetch")) {
                    msg = "CORS ERROR: Browsers block these specific headers (`Referer`, `Origin`, `hacker_is_stinky`). Use a CORS unblocker extension or run via a local proxy.";
                }
                appendMessage('ai', msg, true);
            } finally {
                userInput.disabled = false;
                sendBtn.disabled = false;
                userInput.focus();
            }
        });

        init();
    </script>
</body>
</html>
